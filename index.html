<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>放射科預假單系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .date-header {
            width: 80px;
            min-width: 80px;
            overflow: hidden;
            white-space: nowrap;
            text-align: center;
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        .name-header {
            width: 100px;
            min-width: 100px;
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid #e5e7eb;
        }
        .order-header {
            width: 50px;
            min-width: 50px;
            text-align: center;
            padding: 8px;
            border-bottom: 1px solid #e5e7eb;
        }
        .data-cell {
            width: 80px;
            height: 30px;
            text-align: center;
            border-bottom: 1px solid #f3f4f6;
            padding: 0;
        }
        .name-cell {
            text-align: left;
            padding-left: 8px;
            font-weight: 500;
            border-bottom: 1px solid #f3f4f6;
            height: 30px;
            line-height: 30px;
        }
        .order-cell {
            text-align: center;
            border-bottom: 1px solid #f3f4f6;
            height: 30px;
            line-height: 30px;
        }
        .leave-mark {
            background-color: #f472b6;
            color: white;
            font-weight: bold;
            border-radius: 4px;
            width: 80%;
            height: 80%;
            margin: auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .weekend {
            background-color: #f9fafb;
        }
        .holiday {
            background-color: #fde68a;
        }

        /* 新增的樣式 */
        .leave-form-container {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            background-color: white;
        }
        .add-form-button {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #3b82f6;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-family: 'Inter', sans-serif;
        }
        .add-form-button:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body class="bg-gray-100 p-6">
    <div class="mx-auto max-w-4xl">
        <h1 class="text-2xl font-semibold text-center text-gray-800 mb-6">放射科預假單系統</h1>
        <p class="text-gray-600 text-sm mb-4 text-center">請同仁填寫未來 28 天的休假日期，填寫範例：<span class="font-bold text-pink-600">V</span></p>

        <div id="leave-forms-container">
            </div>

        <button id="add-leave-form" class="add-form-button">新增預假單</button>
    </div>

    <script>
        const leaveFormsContainer = document.getElementById('leave-forms-container');
        const addLeaveFormButton = document.getElementById('add-leave-form');
        const today = new Date();

        // 設定未來 28 天的日期
        const dates = [];
        for (let i = 0; i < 28; i++) {
            const date = new Date(today);
            date.setDate(today.getDate() + i);
            dates.push(date);
        }

        // 定義假日 (範例，可以根據實際情況調整)
        const holidays = [
            "2025-01-01",
            "2025-02-28",
            "2025-04-04",
            "2025-04-05",
            "2025-05-01",
            "2025-06-03",
        ];

        // 員工資料 (範例，可以根據實際情況調整)
          const employees = [
            { name: "陳振堅", order: 1 },
            { name: "莊憶如", order: 2 },
            { name: "朱雁翎", order: 3 },
            { name: "曾紹華", order: 4 },
            { name: "李國偉", order: 5 },
            { name: "洪藝瑄", order: 6 },
            { name: "高元宏", order: 7 },
            { name: "傅奎愿", order: 8 },
            { name: "陳盈熹", order: 9 },
            { name: "蔡芳綺", order: 10 },
            { name: "李宛融", order: 11 },
            { name: "徐啟仁", order: 12 },
            { name: "鄭璟樺", order: 13 },
        ];

        function createDateHeaders() {
            let headerContent = `<table class="min-w-full table-fixed">
                <thead>
                    <tr>
                        <th class="name-header">姓名</th>
                        <th class="order-header">順位</th>`;
            dates.forEach(date => {
                const dateString = date.toLocaleDateString('zh-TW', {
                    year: 'numeric',
                    month: '2-digit',
                }).replace(/\//g, '/');
                const dayOfWeek = date.toLocaleDateString('zh-TW', { weekday: 'short' });
                let dateHeaderContent = `${dateString}<br><span class="text-xs">(${dayOfWeek})</span>`;

                if (date.getDay() === 0 || date.getDay() === 6) {
                    dateHeaderContent = `<span class="weekend">${dateHeaderContent}</span>`;
                }
                const holidayString = date.toISOString().split('T')[0];
                if (holidays.includes(holidayString)) {
                    dateHeaderContent = `<span class="holiday">${dateHeaderContent}<br><span class="text-xs text-red-600">假日</span></span>`;
                }
                headerContent += `<th class="date-header">${dateHeaderContent}</th>`;
            });
            headerContent += `</tr>
                </thead>
                <tbody>`;
            return headerContent;
        }

        function createLeaveForm() {
            const leaveFormContainer = document.createElement('div');
            leaveFormContainer.className = 'leave-form-container';
            leaveFormContainer.innerHTML = createDateHeaders();

            const tableBody = document.createElement('tbody');

            employees.forEach(employee => {
                let rowContent = `
                    <tr>
                        <td class="name-cell">${employee.name}</td>
                        <td class="order-cell">${employee.order}</td>`;
                dates.forEach(date => {
                    const dateString = date.toISOString().split('T')[0];
                    rowContent += `<td class="data-cell" data-date="${dateString}"></td>`;
                });
                rowContent += `</tr>`;
                const row = document.createElement('tr');
                row.innerHTML = rowContent;
                tableBody.appendChild(row);
            });

            leaveFormContainer.querySelector('table').appendChild(tableBody);
            leaveFormsContainer.appendChild(leaveFormContainer);

             // 為每個 data cell 添加事件監聽器
            const dataCells = leaveFormContainer.querySelectorAll('.data-cell');
            dataCells.forEach(cell => {
                cell.addEventListener('click', function () {
                    if (this.textContent === 'V') {
                        this.textContent = '';
                        this.classList.remove('leave-mark');
                    } else {
                        this.textContent = 'V';
                        this.classList.add('leave-mark');
                    }
                });
            });
        }

        addLeaveFormButton.addEventListener('click', createLeaveForm);

        // 初始化時創建一份預假單
        createLeaveForm();
    </script>
</body>
</html>
